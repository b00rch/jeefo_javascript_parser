/**
 * jeefo_javascript_parser : v0.0.8
 * Author                  : je3f0o, <je3f0o@gmail.com>
 * Homepage                : https://github.com/je3f0o/jeefo_javascript_parser
 * License                 : The MIT License
 * Copyright               : 2017
 **/
"use strict";module.exports=function(e){return e.use(function(e){var t=e.module("jeefo_javascript_parser",["jeefo_tokenizer"]);t.namespace("parser.SymbolsTable",["object.assign","JeefoObject"],function(e,t){var r=function(e){this.is=e.is,this.Token=function(){}};r.prototype={assign:e,inherit:function(e,t){this.assign(this.Token.prototype,e,t)}};var n=function(e,r){this.constructors=e||new t,this.expression_symbols=r||new t};return n.prototype={assign:e,Handler:r,SymbolsTable:n,handler:function(e){return new this.Handler(e)},sort_handler:function(e,t){return e.Token.prototype.precedence-t.Token.prototype.precedence},copy:function(){return new this.SymbolsTable(this.constructors.$copy(),this.expression_symbols.$copy())},register_constructor:function(e,t,r){return this.constructors[e]=t,this.assign(t.prototype,this.expression_default_prototypes,r),t.prototype.type=e,t.prototype.on_register&&t.prototype.on_register(t.prototype,this),this},register_expression:function(e,t,r){var n=this.handler(t);return n.inherit(this.expression_default_prototypes,t.protos),void 0===r?n.Token.prototype.type+="Expression":r&&(n.Token.prototype.type+=r),this.constructors[n.Token.prototype.type]=n.Token,n.Token.prototype.on_register&&n.Token.prototype.on_register(n.Token.prototype,this),this.expression_symbols.hasOwnProperty(e)?(this.expression_symbols[e].push(n),this.expression_symbols[e].sort(this.sort_handler)):this.expression_symbols[e]=[n],this},get_expression:function(e){var t=this.expression_symbols[e.current_token.type];if(t)for(var r=t.length-1;r>=0;--r)if(!t[r].is||t[r].is(e.current_token,e)){var n=new t[r].Token;return n.initialize&&n.initialize(e.current_token,e),n}},expression_default_prototypes:{type:"Undefined",precedence:0}},n}),t.namespace("javascript.SymbolsTable",["JeefoObject","object.assign","parser.SymbolsTable"],function(e,t,r){var n=function(t,r,n,i){this.constructors=t||new e,this.expression_symbols=r||new e,this.delimiter_symbols=n||new e,this.binary_expression_symbols=i||new e};return t(n.prototype,r.prototype,{SymbolsTable:n,copy:function(){return new this.SymbolsTable(this.constructors.$copy(),this.expression_symbols.$copy(),this.delimiter_symbols.$copy(),this.binary_expression_symbols.$copy())},delimiter:function(e){return this.delimiter_symbols[e]={type:"Delimiter",precedence:0,character:e},this},register_binary_expression:function(e,t){var r=this.handler(t);return r.inherit(t.protos),r.Token.prototype.type+="Expression",this.constructors[r.Token.prototype.type]=r.Token,r.Token.prototype.on_register&&r.Token.prototype.on_register(r.Token.prototype,this),this.binary_expression_symbols.hasOwnProperty(e)?(this.binary_expression_symbols[e].push(r),this.binary_expression_symbols[e].sort(this.sort_handler)):this.binary_expression_symbols[e]=[r],this},get_binary_expression:function(e){var t=this.binary_expression_symbols[e.current_token.type];if(t)for(var r=t.length-1;r>=0;--r)if(!t[r].is||t[r].is(e.current_token,e)){var n=new t[r].Token;return n.initialize&&n.initialize(e.current_token,e),n}},literal:function(e,t){return t.protos.precedence=31,this.register_expression(e,t,"Literal")},statement:function(e,t){return this.register_expression(e,t,"Statement")},unary_expression:function(e,t){return this.register_expression(e,t,"Expression")},binary_expression:function(e,t){return this.register_binary_expression(e,t)},declaration_expression:function(e,t){return this.register_expression(e,t,t.suffix)}}),n}),t.namespace("javascript.Scope",function(){var e=function(e,t){this.symbols=e,this.tokenizer=t};return e.prototype={Scope:e,$new:function(e){return new this.Scope(e,this.symbols)},parse:function(){var e=[];for(this.advance();this.current_expression;this.advance())this.current_expression.statement_denotation||(console.log("NOT FOUND STMT:",this.current_expression),console.log("NOT FOUND STMT protos:",this.current_expression.__proto__),console.log(this.current_token),process.exit()),e.push(this.current_expression.statement_denotation(this));return e},advance:function(e,t){this.current_token=this.tokenizer.next(),this.current_token?(this.symbols.delimiter_symbols.hasOwnProperty(this.current_token.delimiter)?this.current_expression=this.symbols.delimiter_symbols[this.current_token.value]:this.current_expression=this.symbols.get_expression(this),t?t!==this.current_token[e]&&(console.log("EXPECT TOKEN VALUE",t,this.current_token),this.current_token.error_unexpected_token()):e&&e!==this.current_token.value&&(console.log("EXPECT TOKEN VALUE",e,this.current_token),this.current_token.error_unexpected_token())):this.current_expression=null},advance_binary:function(){this.current_token=this.tokenizer.next(),this.current_token?this.symbols.delimiter_symbols.hasOwnProperty(this.current_token.delimiter)?this.current_expression=this.symbols.delimiter_symbols[this.current_token.value]:this.current_expression=this.symbols.get_binary_expression(this):this.current_expression=null},expression:function(e){var t=this.current_expression;t.null_denotation&&(t=t.null_denotation(this)),this.current_expression&&!this.current_expression.left_denotation&&this.current_expression.precedence>e&&this.advance_binary();for(var r;this.current_expression&&e<this.current_expression.precedence;)t=this.current_expression.left_denotation(t,this),r===t&&(console.log(222222222222,t,this.current_token),process.exit()),r=t;return t}},e}),t.namespace("javascript.Parser",function(){var e=function(e,t,r){this.Scope=r,this.symbols=t,this.tokenizer=e};return e.prototype={Parser:e,copy:function(){return new this.Parser(this.tokenizer.copy(),this.symbols.copy(),this.Scope)},parse:function(e){var t=new this.Scope(this.symbols,this.tokenizer);return this.tokenizer.init(e,4),t.parse()}},e}),t.namespace("javascript.es5_tokenizer",["tokenizer.Tokenizer"],function(e){var t=new e,r=[".",",","/","?",";",":","'",'"',"`","~","-","=","+","\\","|","(",")","[","]","{","}","<",">","!","@","#","%","^","&","*"].join("");return t.register({is:function(e){switch(e){case":":case";":case",":case"?":case"(":case")":case"[":case"]":case"{":case"}":return!0}},protos:{type:"Delimiter",precedence:10,initialize:function(e,t){this.type=this.type,this.value=this.delimiter=e,this.start=t.get_cursor(),this.end=t.end_cursor()}}}).register({is:function(e,t){if("/"===e)switch(t.peek(t.cursor.index+1)){case"*":case"/":return!0}},protos:{type:"Comment",precedence:40,initialize:function(e,t){var r,n,i,s=t.get_cursor();if(this.type=this.type,"*"===t.next()){var o=t.cursor;for(e=t.next(!0),r=t.cursor.index;e;){if(n=t.cursor.index,"*"===e&&"/"===t.peek(o.index+1)){t.next();break}e=t.next(!0),i||(r=t.cursor.index,i=!0)}this.comment=t.seek(r,n),this.is_multiline=!0}else{for(e=t.next(),r=t.cursor.index;e&&"\n"!==e;)e=t.next(),i||(r=t.cursor.index,i=!0);this.comment=t.seek(r),this.is_multiline=!1}this.start=s,this.end=t.get_cursor()}}}).register({protos:{type:"Identifier",DELIMITERS:r,initialize:function(e,t){for(var r=t.get_cursor(),n={};e&&e>" "&&-1===this.DELIMITERS.indexOf(e);)t.assign(n,t.cursor),e=t.next();this.type=this.type,this.name=t.seek(r.index),this.start=r,this.end=t.get_cursor(),t.cursor=n}}}).register({is:function(e){return e>="0"&&e<="9"},protos:{type:"Number",precedence:2,initialize:function(e,t){for(var r=t.get_cursor(),n={};e&&e>="0"&&e<="9";)t.assign(n,t.cursor),e=t.next();if(e&&"."===e)for(e=t.next();e&&e>="0"&&e<="9";)t.assign(n,t.cursor),e=t.next();if(e&&("e"===e||"E"===e))for(e=t.next();e&&e>="0"&&e<="9";)t.assign(n,t.cursor),e=t.next();this.type=this.type,this.value=t.seek(r.index),this.start=r,this.end=t.get_cursor(),t.cursor=n}}}).register({is:function(e){return'"'===e||"'"===e},protos:{type:"String",precedence:1,initialize:function(e,t){var r,n=t.get_cursor(),i=e;for(e=t.next(),r=t.cursor.index;e&&e>=" "&&e!==i;)"\\"===e&&t.next(),e=t.next();this.type=this.type,this.quote=i,this.value=t.seek(r),this.start=n,this.end=t.end_cursor()}}}).register({is:function(e){switch(e){case".":case"!":case"<":case">":case"=":case"+":case"-":case"*":case"%":case"&":case"|":case"^":case"~":return!0}},protos:{type:"Operator",precedence:20,initialize:function(e,t){var r=t.get_cursor(),n=t.cursor;switch(e){case"!":case"=":"="===t.peek(n.index+1)&&(t.move_right(1),"="===t.peek(n.index+1)&&t.move_right(1));break;case"+":case"-":case"&":case"|":switch(t.peek(n.index+1)){case"=":case e:t.move_right(1)}break;case"/":case"%":case"^":"="===t.peek(n.index+1)&&t.move_right(1);break;case"*":"*"===t.peek(n.index+1)&&t.move_right(1),"="===t.peek(n.index+1)&&t.move_right(1);break;case"<":"<"===t.peek(n.index+1)&&t.move_right(1),"="===t.peek(n.index+1)&&t.move_right(1);break;case">":">"===t.peek(n.index+1)&&(t.move_right(1),">"===t.peek(n.index+1)&&t.move_right(1)),"="===t.peek(n.index+1)&&t.move_right(1)}this.type=this.type,this.operator=t.seek(r.index,n.index+1),this.start=r,this.end=t.end_cursor()}}}).register({is:function(e,t){if("/"===e){switch(t.peek(t.cursor.index+1)){case"*":case"/":return!1}return!0}},protos:{type:"Slash",precedence:50,DELIMITERS:r,initialize:function(e,t){this.type=this.type,this.start=t.get_cursor(),this.end=t.end_cursor()}}}),t});t.namespace("javascript.es5_symbols",["javascript.SymbolsTable"],function(e){var t=new e,r=function(e){this.type=this.type,this.operator=e.operator},n=function(e,t){this.type=this.type,this.expression=t,this.start=e},i=function(e){e.ExpressionStatement=n},s=function(e){var t=new this.ExpressionStatement(e.current_expression.start,e.expression(0));if(e.current_token){if(";"===e.current_token.delimiter)return t.end=e.current_token.end,t;console.log(22222222,t,e.current_expression,e.current_token),e.current_token.error_unexpected_token()}return t.end=t.expression.end,t},o={suffix:!1,protos:{type:"Comment",precedence:40,initialize:function(e){this.type="Comment",this.comment=e.comment,this.is_multiline=e.is_multiline,this.start=e.start,this.end=e.end},left_denotation:function(e,t){for(;t.current_expression&&"Comment"===t.current_expression.type;)t.advance_binary();return e},statement_denotation:function(){return this}}},a={type:"Unary",precedence:16,initialize:r,null_denotation:function(e){var t=e.current_token.start;return e.advance(),this.argument=e.expression(16),this.is_prefix=!0,this.start=t,this.end=this.argument.end,this},on_register:i,statement_denotation:s},c={initialize_multi_characters_operator:r,protos:{initialize:function(){this.type=this.type},left_denotation:function(e,t){return this.left=e,t.advance(),this.right=t.expression(this.precedence),this.start=e.start,this.end=this.right.end,this}},make:function(e,t){return this.protos.type=e,this.protos.precedence=t,this.protos}};n.prototype.type="ExpressionStatement",t.delimiter(":").delimiter(")").delimiter("]").delimiter("}").binary_expression("Delimiter",{is:function(e){return";"===e.delimiter},protos:{type:"Delimiter",initialize:function(){this.type=this.type,this.delimiter=";"},statement_denotation:function(e){return this.start=e.current_token.start,this.end=e.current_token.end,this}}}).literal("Identifier",{is:function(e){return"null"===e.value},protos:{type:"Null",initialize:function(e){this.type=this.type,this.start=e.start,this.end=e.end},on_register:i,statement_denotation:s}}).literal("Delimiter",{is:function(e){return"["===e.delimiter},protos:{type:"Array",initialize:function(e,t){this.type=this.type,this.elements=[],this.start=e.start;var r=0;for(t.advance();t.current_token&&"]"!==t.current_token.delimiter;){for(;t.current_expression&&"Comment"===t.current_expression.type;)this.elements[r++]=t.current_expression,t.advance();","===t.current_token.delimiter?this.elements[r++]=null:this.elements[r++]=t.expression(1),","===t.current_token.delimiter&&t.advance()}this.end=t.current_token.end},on_register:i,statement_denotation:s}}).literal("Number",{protos:{type:"Number",initialize:function(e){this.type=this.type,this.value=e.value,this.start=e.start,this.end=e.end},on_register:i,statement_denotation:s}}).literal("String",{protos:{type:"String",initialize:function(e){this.type=this.type,this.quote=e.quote,this.value=e.value,this.start=e.start,this.end=e.end},on_register:i,statement_denotation:s}}).literal("Slash",{protos:{type:"RegExp",REGEX_FLAGS:"gimuy",initialize:function(e,t){for(var r,n,i=t.tokenizer.streamer,s=i.get_cursor(),o=i.next(),a=i.cursor.index,c="";o&&o>" "&&"/"!==o;)"\\"===o&&i.next(),o=i.next();for(n=i.seek(a),r=i.get_cursor(),o=i.next();o&&o>" ";)if(-1!==this.REGEX_FLAGS.indexOf(o)&&-1===c.indexOf(o))c+=o,i.assign(r,i.cursor),o=i.next();else{if(-1!==e.DELIMITERS.indexOf(o))break;e.error("Invalid regular expression flags")}i.cursor=r,this.type=this.type,this.regex={pattern:n,flags:c},this.start=s,this.end=i.end_cursor(),t.current_expression=this},on_register:i,statement_denotation:s}}).literal("Identifier",{is:function(e){switch(e.value){case"true":case"false":return!0}},protos:{type:"Boolean",initialize:function(e){this.type=this.type,this.value=e.value,this.start=e.start,this.end=e.end},on_register:i,statement_denotation:s}}).binary_expression("Comment",o).declaration_expression("Comment",o).declaration_expression("Identifier",{suffix:!1,protos:{type:"Identifier",precedence:2,initialize:function(e){this.type=this.type,this.name=e.name,this.start=e.start,this.end=e.end,this.precedence=21},on_register:function(e){e.ExpressionStatement=n,e.LabeledStatement=function(e){this.type=this.type,this.label=e},e.LabeledStatement.prototype.type="LabeledStatement"},expression_statement:s,statement_denotation:function(e){for(var t=e.tokenizer,r=t.streamer.get_cursor(),n=t.next();n&&"Comment"===n.type;)n=t.next();if(n&&":"===n.delimiter){var i=new this.LabeledStatement(e.current_expression);return e.advance(),i.statement=e.current_expression.statement_denotation(e),i.start=i.label.start,i.end=i.statement.end,i}return t.streamer.cursor=r,this.expression_statement(e)}}}).binary_expression("Delimiter",{is:function(e){return","===e.delimiter},suffix:!1,protos:{type:"Sequence",precedence:1,initialize:c.protos.initialize,left_denotation:function(e,t){var r=this.expressions=[e],n=1;for(this.start=e.start,t.advance();t.current_expression&&t.current_expression.precedence;)r[n++]=t.expression(1),t.current_expression&&t.current_expression.precedence&&(","===t.current_token.delimiter?t.advance():t.current_token.error_unexpected_token());return this.end=r[r.length-1].end,this}}}).declaration_expression("Delimiter",{is:function(e){return"{"===e.delimiter},suffix:!1,protos:{type:"CurlyBrackets",precedence:21,initialize:function(e,t){var r=t.tokenizer.streamer,n=r.get_cursor();if(t.advance(),"}"!==t.current_token.delimiter){if(t.current_expression&&"Comment"===t.current_expression.type)for(t.advance();t.current_expression&&"Comment"===t.current_expression.type;)t.advance();else t.advance();for(;t.current_expression&&"Comment"===t.current_expression.type;)t.advance();if(":"===t.current_token.value)return r.cursor=n,t.current_token=e,void(this.type="ObjectLiteral")}this.type=this.type,r.cursor=n,t.current_token=e},on_register:function(e){e.Property=function(e,t){this.type=this.type,this.key=e,this.value=t,this.start=e.start,this.end=t.end},e.Property.prototype.type="Property"},null_denotation:function(e){var t,r=0,n=this.properties=[],i=e.current_token.start;for(e.advance();e.current_expression&&"Comment"===e.current_expression.type;)n[r++]=e.current_expression,e.advance();for(;e.current_token&&"}"!==e.current_token.value;){switch(e.current_expression.type){case"Identifier":case"NumberLiteral":case"StringLiteral":t=e.current_expression,e.advance()}for(":"===e.current_token.value?e.advance():e.current_token.error_unexpected_token(),n[r++]=new this.Property(t,e.expression(1)),","===e.current_token.value&&e.advance();e.current_expression&&"Comment"===e.current_expression.type;)n[r++]=e.current_expression,e.advance()}return"CurlyBrackets"===this.type&&(this.type="ObjectLiteral"),this.start=i,this.end=e.current_token.end,e.current_expression=this,this},statement:function(e){this.type="BlockStatement";var t=0,r=this.body=[];for(this.start=e.current_token.start,e.advance();e.current_expression&&e.current_expression.statement_denotation;e.advance())r[t++]=e.current_expression.statement_denotation(e);return"}"===e.current_token.delimiter?this.end=e.current_token.end:e.current_token.error_unexpected_token(),this},statement_denotation:function(e){return"ObjectLiteral"===this.type?this.null_denotation(e):this.statement(e)}}}).declaration_expression("Delimiter",{is:function(e){return"("===e.delimiter},protos:{type:"Grouping",precedence:20,initialize:c.protos.initialize,null_denotation:function(e){var t=e.current_token.start;return e.advance(),this.expression=e.expression(0),")"===e.current_token.delimiter?(this.start=t,this.end=e.current_token.end,e.current_expression=this):e.current_token.error_unexpected_token(),this},on_register:i,statement_denotation:s}}).binary_expression("Operator",{is:function(e){return"."===e.operator},protos:{type:"Member",precedence:19,initialize:c.protos.initialize,left_denotation:function(e,t){for(this.object=e,t.advance();"Comment"===t.current_expression.type;)t.advance();return"Identifier"===t.current_token.type?(this.property=t.current_token,this.is_computed=!1,this.start=e.start,this.end=this.property.end,t.advance_binary()):(console.log(22222222,t.current_expression,t.current_token),t.current_token.error_unexpected_token()),this}}}).binary_expression("Delimiter",{is:function(e){return"["===e.delimiter},protos:{type:"Member",precedence:19,initialize:c.protos.initialize,left_denotation:function(e,t){return this.object=e,t.advance(),this.property=t.expression(0),this.is_computed=!0,"]"===t.current_token.delimiter?(this.start=e.start,this.end=t.current_token.end,t.advance_binary()):(console.log(44444,this,t.current_token),t.current_token.error_unexpected_token()),this}}}).binary_expression("Delimiter",{is:function(e){return"("===e.delimiter},protos:{type:"Call",precedence:18,initialize:c.protos.initialize,get_arguments:function(e,t){var r=0,n=t.arguments;e.advance();e:for(;e.current_token&&")"!==e.current_token.delimiter;)switch(n[r++]=e.expression(1),e.current_token||console.error("Unexpected end"),","!==e.current_token.delimiter&&")"!==e.current_token.delimiter&&e.advance(),e.current_token.delimiter){case",":e.advance();break;case")":break e;default:console.log(n,e.current_expression),e.current_token.error_unexpected_token()}t.end=e.current_token.end},get_params:function(e){var t=0,r=[];for(e.advance();e.current_expression&&"Comment"===e.current_expression.type;)e.advance();for(;e.current_token&&")"!==e.current_token.delimiter;){for("Identifier"===e.current_expression.type?(r[t++]=e.current_expression,e.advance()):e.current_token.error_unexpected_token(),e.current_token||console.error("Unexpected end");e.current_expression&&"Comment"===e.current_expression.type;)e.advance();switch(e.current_token.delimiter){case")":return r;case",":e.advance();break;default:e.current_token.error_unexpected_token()}for(;e.current_expression&&"Comment"===e.current_expression.type;)e.advance()}return r},left_denotation:function(e,t){switch(e.type){case"Identifier":case"CallExpression":case"MemberExpression":case"FunctionExpression":return this.callee=e,this.arguments=[],this.start=e.start,this.get_arguments(t,this),t.advance_binary(),this;case"NewExpression":return this.get_arguments(t,e),e.end=this.end,e;case"GroupingExpression":return console.log("WHAAAAAAAAAAAAAAAT ??????"),e}t.current_token.error_unexpected_token()}}}).unary_expression("Identifier",{is:function(e){return"new"===e.name},protos:{type:"New",precedence:18,initialize:c.protos.initialize,null_denotation:function(e){var t=e.current_token.start;return e.advance(),this.callee=e.expression(18),this.arguments=[],this.start=t,this.end=this.callee.end,e.current_expression&&"CallExpression"===e.current_expression.type&&(e.current_expression.get_arguments(e,this),this.precedence=19),e.current_expression=this,this},on_register:i,statement_denotation:s}}).binary_expression("Operator",{is:function(e){switch(e.operator){case"++":case"--":return!0}},protos:{type:"Unary",precedence:17,initialize:r,left_denotation:function(e,t){return this.argument=e,this.is_prefix=!1,this.start=e.start,this.end=t.current_token.end,t.advance_binary(),this}}}).unary_expression("Operator",{is:function(e){switch(e.operator){case"!":case"~":case"+":case"-":case"++":case"--":return!0}},protos:a}).unary_expression("Identifier",{is:function(e){switch(e.name){case"void":case"typeof":case"delete":return e.operator=e.name,!0}},protos:a}).binary_expression("Operator",{is:function(e){return"**"===e.operator},protos:{type:"Exponentiation",precedence:15,initialize:r,left_denotation:c.protos.left_denotation}}).binary_expression("Operator",{is:function(e){switch(e.operator){case"*":case"%":return!0}},protos:{type:"Binary",precedence:14,initialize:r,left_denotation:c.protos.left_denotation}}).binary_expression("Slash",{protos:{type:"Binary",precedence:14,initialize:r,left_denotation:c.protos.left_denotation}}).binary_expression("Operator",{is:function(e){switch(e.operator){case"-":case"+":return!0}},protos:{type:"Binary",precedence:13,initialize:r,left_denotation:c.protos.left_denotation}}).binary_expression("Operator",{is:function(e){switch(e.operator){case"<<":case">>":case">>>":return!0}},protos:{type:"BitwiseShift",precedence:12,initialize:r,left_denotation:c.protos.left_denotation}}).binary_expression("Operator",{is:function(e){switch(e.operator){case"<":case">":case"<=":case">=":return!0}},protos:{type:"Comparision",precedence:11,initialize:r,left_denotation:c.protos.left_denotation}}).binary_expression("Identifier",{is:function(e){return"in"===e.name},protos:c.make("In",11)}).binary_expression("Identifier",{is:function(e){return"instanceof"===e.name},protos:c.make("Instanceof",11)}).binary_expression("Operator",{is:function(e){switch(e.operator){case"==":case"===":case"!=":case"!==":return!0}},protos:{type:"Equality",precedence:10,initialize:r,left_denotation:c.protos.left_denotation}}).binary_expression("Operator",{is:function(e){return"&"===e.operator},protos:c.make("BitwiseAnd",9)}).binary_expression("Operator",{is:function(e){return"^"===e.operator},protos:c.make("BitwiseXor",8)}).binary_expression("Operator",{is:function(e){return"|"===e.operator},protos:c.make("BitwiseOr",7)}).binary_expression("Operator",{is:function(e){return"&&"===e.operator},protos:c.make("LogicalAnd",6)}).binary_expression("Operator",{is:function(e){return"||"===e.operator},protos:c.make("LogicalAnd",5)}).binary_expression("Delimiter",{is:function(e){return"?"===e.delimiter},protos:{type:"Conditional",precedence:4,initialize:c.protos.initialize,left_denotation:function(e,t){return this.test=e,t.advance(),this.consequent=t.expression(0),":"===t.current_token.delimiter?(t.advance(),this.alternate=t.expression(1)):t.current_token.error_unexpected_token(),this.start=e.start,this.end=this.alternate.end,this}}}).binary_expression("Operator",{is:function(e){switch(e.operator){case"=":case"+=":case"-=":case"*=":case"/=":case"%=":case"&=":case"|=":case"^=":case"**=":case"<<=":case">>=":case">>>=":return!0}},protos:{type:"Assignment",precedence:3,initialize:r,left_denotation:c.protos.left_denotation}}).declaration_expression("Identifier",{is:function(e){return"function"===e.name},protos:{type:"Function",precedence:31,initialize:function(e,t){return this.type=this.type,t.advance_binary(),"Identifier"===t.current_token.type?(this.id=t.current_token,t.advance_binary("(")):this.id=null,"("===t.current_token.value?this.parameters=t.current_expression.get_params(t):t.current_token.error_unexpected_token(),t.advance(),"{"===t.current_token.delimiter?(this.body=t.current_expression.statement(t),this.start=e.start,this.end=this.body.end):t.current_token.error_unexpected_token(),t.current_expression=this,this},statement_denotation:function(){return this.type="FunctionDeclaration",this}}}),t.statement("Delimiter",{is:function(e){return";"===e.delimiter},protos:{type:"Empty",initialize:c.protos.initialize,statement_denotation:function(e){return this.start=e.current_token.start,this.end=e.current_token.end,this}}}).declaration_expression("Identifier",{is:function(e){return"var"===e.name},suffix:!1,protos:{type:"VariableDeclaration",precedence:31,on_register:function(e){e.VariableDeclarator=function(e){this.type=this.type,this.id=e,this.init=null,this.start=e.start},e.VariableDeclarator.prototype.type="VariableDeclarator"},initialize:function(e){this.type=this.type,this.declarations=[],this.ASI=!0,this.start=e.start},statement_denotation:function(e){e.advance();for(var t;e.current_expression;){for(;"Comment"===e.current_expression.type;)this.declarations.push(e.current_expression),e.advance();if("Identifier"===e.current_expression.type?t=this.declare(e.current_expression):e.current_token.error(),e.advance_binary(),e.current_expression||console.log(e.current_token),"="===e.current_expression.operator&&(e.advance(),t.init=e.expression(1)),t.end=t.init?t.init.end:t.id.end,e.current_token)switch(e.current_token.delimiter){case",":e.advance();break;case";":return this.ASI=!1,this.end=e.current_token.end,this;default:if(0===t.end.column)return this.end=t.end,e.tokenizer.streamer.cursor.index=e.current_token.start.index-1,this;console.log("unexpected end of var",e.current_token,t),e.current_token.error_unexpected_token()}}return this.end=t.end,this},declare:function(e){return e=new this.VariableDeclarator(e),this.declarations.push(e),e}}});var p=function(e){var t=e.current_token.start,r=e.current_token.end;return e.advance(),!e.current_token||0===r.column||e.current_token.start.line>r.line?(this.argument=null,this.ASI=!0):";"===e.current_token.delimiter?(r=e.current_token.end,this.argument=null,this.ASI=!1):(this.argument=e.expression(0),e.current_token?";"===e.current_token.delimiter?(r=e.current_token.end,this.ASI=!1):(r=this.argument.end,this.ASI=!0,e.tokenizer.streamer.cursor.index=e.current_token.start.index-1):(r=this.argument.end,this.ASI=!0)),this.start=t,this.end=r,this};t.statement("Identifier",{is:function(e){return"throw"===e.name},protos:{type:"Throw",precedence:31,initialize:c.protos.initialize,statement_denotation:p}}).statement("Identifier",{is:function(e){return"return"===e.name},protos:{type:"Return",precedence:31,initialize:c.protos.initialize,statement_denotation:p}});var u=function(e){var t=e.current_expression.start;return this.type=this.type,e.advance(),"Identifier"===e.current_expression.type?(this.label=e.current_expression,e.advance(";")):this.label=null,this.start=t,this.end=e.current_token.end,this};return t.statement("Identifier",{is:function(e){return"break"===e.name},protos:{type:"Break",precedence:31,initialize:c.protos.initialize,statement_denotation:u}}).statement("Identifier",{is:function(e){return"continue"===e.name},protos:{type:"Continue",precedence:31,initialize:c.protos.initialize,statement_denotation:u}}).statement("Identifier",{is:function(e){return"if"===e.name},protos:{type:"If",precedence:31,initialize:c.protos.initialize,statement_denotation:function(e){var t=e.current_token.start;e.advance("("),e.advance(),this.test=e.expression(0),e.advance(),this.statement=e.current_expression.statement_denotation(e);var r=e.current_token,n=e.tokenizer.streamer,i=n.get_cursor();return e.advance(),e.current_expression&&"else"===e.current_expression.name?(e.advance(),this.alternate=e.current_expression.statement_denotation(e)):(this.alternate=null,n.cursor=i,e.current_token=r),this.start=t,this.end=(this.alternate||this.statement).end,this}}}).statement("Identifier",{is:function(e){return"for"===e.name},protos:{type:"For",precedence:31,initialize:c.protos.initialize,on_register:function(e,t){e.ForInStatement=function(e,t){this.type=this.type,this.left=e,this.right=t},e.ForInStatement.prototype.type="ForInStatement",e.VariableDeclaration=t.constructors.VariableDeclaration},statement_denotation:function(e){var t,r=this,n=e.current_token.start,i=e.tokenizer.streamer;if(e.advance("("),t=i.get_cursor(),e.advance(),e.current_expression&&"VariableDeclaration"===e.current_expression.type){var s=new r.VariableDeclaration;if(s.type=s.type,s.declarations=[],s.start=e.current_expression.start,e.advance(),"Identifier"===e.current_expression.type)if(s.declare(e.current_expression),e.advance_binary(),e.current_expression&&"InExpression"===e.current_expression.type){e.advance();var o=e.expression(0);r=new r.ForInStatement(s,o)}else"="===e.current_expression.operator?(i.cursor=t,e.advance(),r.init=e.current_expression.statement_denotation(e)):e.current_token.error_unexpected_token();else e.current_token.error_unexpected_token()}else";"===e.current_token.value?r.init=null:r.init=e.expression(0);return";"===e.current_token.value?(e.advance(),";"===e.current_token.value?r.test=null:r.test=e.expression(0),e.advance(),r.update=e.expression(0)):r.init&&"InExpression"===r.init.type?r=new r.ForInStatement(r.init.left,r.init.right):"ForInStatement"!==r.type&&e.current_token.error_unexpected_token(),")"===e.current_token.value&&e.advance(),r.statement=e.current_expression.statement_denotation(e),r.start=n,r.end=e.current_token.end,r}}}).statement("Identifier",{is:function(e){return"while"===e.name},protos:{type:"While",precedence:31,initialize:c.protos.initialize,statement_denotation:function(e){var t=e.current_token.start;return e.advance("("),e.advance(),this.test=e.expression(0),")"===e.current_token.value?e.advance():e.current_token.error_unexpected_token(),this.statement=e.current_expression.statement_denotation(e),this.start=t,this.end=this.statement.end,this}}}).statement("Identifier",{is:function(e){return"do"===e.name},protos:{type:"DoWhile",precedence:31,initialize:c.protos.initialize,statement_denotation:function(e){var t=e.current_token.start;return e.advance(),this.statement=e.current_expression.statement_denotation(e),e.advance("name","while"),e.advance("("),e.advance(),this.test=e.expression(0),")"===e.current_token.value&&e.advance(),";"===e.current_token.value?(this.start=t,this.end=e.current_token.end):e.current_token.error_unexpected_token(),this}}}).statement("Identifier",{is:function(e){return"switch"===e.name},protos:{type:"Switch",precedence:31,initialize:c.protos.initialize,statement_denotation:function(e){var t=e.current_expression.start;return e.advance("("),e.advance(),this.discriminant=e.expression(0),")"===e.current_token.delimiter?(e.advance("{"),this.cases=[],this.parse_cases(e,this.cases)):e.current_token.error_unexpected_token(),this.start=t,this.end=e.current_token.end,this},on_register:function(e){e.SwitchCase=function(){this.type=this.type},e.SwitchCase.prototype.type="SwitchCase",e.DefaultCase=function(){this.type=this.type,this.statements=[]},e.DefaultCase.prototype.type="DefaultCase"},parse_cases:function(e,t){var r,n;for(e.advance();"}"!==e.current_token.delimiter;){for(n=e.current_token.start;"Comment"===e.current_expression.type;)t.push(e.current_expression),e.advance();switch(e.current_expression.name){case"case":r=new this.SwitchCase,e.advance(),r.test=e.expression(0),":"!==e.current_token.delimiter&&e.current_token.error_unexpected_token();break;case"default":r=new this.DefaultCase,e.advance(":");break;default:console.log(e.current_token),e.current_token.error()}for(r.statements=[],r.start=n,r.end=e.current_token.end,e.advance();e.current_expression&&e.current_expression&&"}"!==e.current_token.delimiter&&"case"!==e.current_expression.name&&"default"!==e.current_expression.name;)r.statements.push(e.current_expression.statement_denotation(e)),e.advance();r.statements.length&&(r.end=r.statements[r.statements.length-1].end),t.push(r)}}}}).statement("Identifier",{is:function(e){return"try"===e.name},protos:{type:"Try",precedence:31,initialize:c.protos.initialize,statement_denotation:function(e){var t,r,n=e.current_token.start,i=e.tokenizer.streamer;return e.advance("{"),this.block=e.current_expression.statement(e),e.advance(),
"catch"===e.current_expression.name?(this.handler=this._catch(e),t=e.current_token,r=i.get_cursor(),e.advance()):this.handler=null,"finally"===e.current_expression.name?(e.advance("{"),this.finalizer=e.current_expression.statement(e)):t?(this.finalizer=null,i.cursor=r,e.current_token=t):console.error("Missing catch or finally after try"),this.start=n,this.end=(this.finalizer||this.handler).end,this},on_register:function(e){e.CatchClause=function(){this.type=this.type},this.CatchClause.prototype.type="CatchClause"},_catch:function(e){var t=new this.CatchClause,r=e.current_expression.start;return e.advance("("),e.advance(),t.param=e.expression(1),")"===e.current_token.value&&(e.advance("{"),t.body=e.current_expression.statement(e),t.start=r,t.end=t.body.end),t}}}),t}).namespace("javascript.ES5_parser",["javascript.Scope","javascript.Parser","javascript.es5_tokenizer","javascript.es5_symbols"],function(e,t,r,n){return new t(r,n,e)}),t.namespace("javascript.es6_tokenizer",["javascript.es5_tokenizer"],function(e){var t=e.copy();return t.register({is:function(e){return"`"===e},protos:{type:"BackTick",precedence:1,initialize:function(e,t){this.type=this.type,this.start=t.get_cursor(),this.end=t.end_cursor()}}}).register({is:function(e,t){return"="===e&&">"===t.peek(t.cursor.index+1)},protos:{type:"ArrowFunctionPunctuator",precedence:21,initialize:function(e,t){this.type=this.type,this.operator=this.value="=>",this.start=t.get_cursor(),t.move_right(1),this.end=t.end_cursor()}}}),t}),t.namespace("javascript.ES6_parser",["javascript.ES5_parser","javascript.es6_tokenizer"],function(e,t){e=e.copy(),e.tokenizer=t;var r=function(e,t){e.ExpressionStatement=t.constructors.StringLiteral.prototype.ExpressionStatement,e.statement_denotation=t.constructors.StringLiteral.prototype.statement_denotation};return e.symbols.literal("BackTick",{protos:{type:"Template",precedence:21,initialize:function(e,t){var r=t.tokenizer.streamer,n=r.next(),i=e.end,s=0,o=[];e:for(;n;)switch(n){case"\\":r.move_right(1),n=r.next();break;case"$":if("{"===r.peek(r.cursor.index+1)){if(r.cursor.index>i.index&&(o[s++]=new this.TemplateLiteralString(i,r.get_cursor(),r.seek(i.index))),i=r.get_cursor(),r.move_right(1),t.advance(),o[s++]=new this.TemplateLiteralExpression(i,t.expression(0)),"}"!==t.current_token.delimiter)throw new Error("WTF");o[s-1].end=t.current_token.end,n=r.next(),i=r.get_cursor()}else n=r.next();break;case"`":r.cursor.index>i.index&&(o[s++]=new this.TemplateLiteralString(i,r.get_cursor(),r.seek(i.index)));break e;default:n=r.next()}this.type=this.type,this.body=o,this.start=e.start,this.end=r.end_cursor()},on_register:function(e,t){e.TemplateLiteralString=function(e,t,r){this.type=this.type,this.value=r,this.start=e,this.end=t},e.TemplateLiteralString.prototype.type="TemplateLiteralString",e.TemplateLiteralExpression=function(e,t){this.type=this.type,this.expression=t,this.start=e},e.TemplateLiteralExpression.prototype.type="TemplateLiteralExpression",r(e,t)}}}).literal("Identifier",{is:function(e,t){return"`"===t.tokenizer.streamer.peek(t.tokenizer.streamer.cursor.index+1)},protos:{type:"TaggedTemplate",precedence:21,on_register:r,initialize:function(e,t){this.type=this.type,this.tag=t.current_token,t.advance(),this.template=t.current_expression,this.start=this.tag.start,this.end=this.template.end}}}).declaration_expression("Identifier",{is:function(e,t){var r=t.tokenizer,n=r.streamer.get_cursor(),i=r.next(!0);return r.streamer.cursor=n,i&&"=>"===i.operator},protos:{type:"ArrowFunction",precedence:21,on_register:r,initialize:function(e,t){t.advance("=>"),t.advance("{"),this.type=this.type,this.parameters=[e],this.body=t.current_expression.statement(t),this.start=e.start,this.end=this.body.end}}}).declaration_expression("Delimiter",{is:function(e,t){if("("===e.delimiter){for(var r=t.tokenizer,n=r.streamer.get_cursor(),i=r.next();i&&")"!==i.delimiter;)i=r.next();return i=r.next(!0),r.streamer.cursor=n,i&&"=>"===i.operator}},protos:{type:"ArrowFunction",precedence:21,on_register:r,initialize:function(e,t){t.tokenizer.streamer.cursor.index-=1,t.advance_binary(),this.type=this.type,this.parameters=t.current_expression.get_params(t),t.advance("=>"),t.advance("{"),this.body=t.current_expression.statement(t),this.start=e.start,this.end=this.body.end}}}).statement("Identifier",{is:function(e){return"export"===e.name},protos:{type:"Export",precedence:31,initialize:function(){this.type=this.type},statement_denotation:function(e){var t=e.current_token.start;if(e.advance(),e.current_expression&&"default"===e.current_expression.name)if(this.type="ExportDefaultDeclaration",e.advance(),e.current_expression){if("FunctionExpression"===e.current_expression.type)return this.declaration=e.current_expression,this.declaration.type="FunctionDeclaration",this.start=t,this.end=this.declaration.end,this;if(this.declaration=e.expression(0),";"===e.current_token.delimiter)return this.start=t,this.end=e.current_token.end,this;e.current_token.error_unexpected_token()}else console.error("ERRRRRRRRRRR export expression")}}}),e})}),e};