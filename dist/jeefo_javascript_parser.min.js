/**
 * jeefo_javascript_parser : v0.0.6
 * Author                  : je3f0o, <je3f0o@gmail.com>
 * Homepage                : https://github.com/je3f0o/jeefo_javascript_parser
 * License                 : The MIT License
 * Copyright               : 2017
 **/
!function(e,t,r){"use strict";e.use(function(e){var t=e.module("jeefo_javascript_parser",["jeefo_tokenizer"]);t.namespace("javascript.es5_regions",["tokenizer.Region"],function(e){var t=new e("javascript");return t.register({type:"Comment",name:"Inline comment",start:"//",end:"\n"}),t.register({type:"Comment",name:"Multi line comment",start:"/*",end:"*/"}),t.register({type:"String",name:"Double quote string",start:'"',escape_char:"\\",end:'"'}),t.register({type:"String",name:"Single quote string",start:"'",escape_char:"\\",end:"'"}),t.register({type:"TemplateLiteral quasi string",start:null,escape_char:"\\",end:"${",until:!0,contained:!0}),t.register({type:"TemplateLiteral expression",start:"${",end:"}",contains:[{type:"Block"},{type:"Array"},{type:"String"},{type:"RegExp"},{type:"Comment"},{type:"Parenthesis"},{type:"SpecialCharacter",chars:["-","_","+","*","%","&","|","$","?","`","=","!","<",">","\\",":",".",",",";"]}]}),t.register({type:"TemplateLiteral",start:"`",end:"`",contains:[{type:"TemplateLiteral quasi string"},{type:"TemplateLiteral expression"}],keepend:!0}),t.register({type:"Parenthesis",name:"Parenthesis",start:"(",end:")",contains:[{type:"Block"},{type:"Array"},{type:"String"},{type:"RegExp"},{type:"Comment"},{type:"Parenthesis"},{type:"TemplateLiteral"},{type:"SpecialCharacter",chars:["-","_","+","*","%","&","|","$","?","`","=","!","<",">","\\",":",".",",",";"]}]}),t.register({type:"Array",name:"Array literal",start:"[",end:"]",contains:[{type:"Block"},{type:"Array"},{type:"String"},{type:"Comment"},{type:"Parenthesis"},{type:"SpecialCharacter",chars:["-","_","+","*","%","&","|","$","?","`","=","!","<",">",":",".",",",";"]}]}),t.register({type:"Block",name:"Block",start:"{",end:"}",contains:[{type:"Block"},{type:"Array"},{type:"String"},{type:"RegExp"},{type:"Comment"},{type:"Parenthesis"},{type:"TemplateLiteral"},{type:"SpecialCharacter",chars:["-","_","+","*","%","&","|","$","?","`","=","!","<",">","\\",":",".",",",";"]}]}),t.register({type:"RegExp",name:"RegExp",start:"/",skip:"\\/",end:"/"}),t}),t.namespace("javascript.tokenizer",["tokenizer.TokenParser","javascript.es5_regions"],function(e,t){return function(r){return new e("javascript",t).parse(r)}}),t.namespace("javascript.Parser",["javascript.tokenizer","tokenizer.Token"],function(e,t){var r=["break","continue","return","do","for","while","switch","case","default","in","typeof","instanceof","try","catch","finally","throw","var","function","this","new","debugger","if","else","with","delete","void"],s=function(e,t){this.reserved=r,e&&(this.statement_middlewares=e),t&&(this.expression_middlewares=t)},n=s.prototype;n.EmptyStatement=function(e){this.type="EmptyStatement",this.start=e.start,this.end=e.end},n.IfStatement=function(e,t,r,s,n){this.type="IfStatement",this.test=r,this.statement=s,this.alternate=n||null,this.start=e,this.end=t},n.ForStatement=function(e,t,r,s,n,a){this.type="ForStatement",this.init=r,this.test=s,this.update=n,this.statement=a,this.start=e,this.end=t},n.ForInStatement=function(e,t,r,s,n){this.type="ForInStatement",this.left=r,this.right=s,this.statement=n,this.start=e,this.end=t},n.WhileStatement=function(e,t,r,s){this.type="WhileStatement",this.test=r,this.statement=s,this.start=e,this.end=t},n.SwitchStatement=function(e,t,r,s){this.type="SwitchStatement",this.test=r,this.cases=s,this.start=e,this.end=t},n.LabeledStatement=function(e,t,r,s){this.type="LabeledStatement",this.label=r,this.statement=s,this.start=e,this.end=t},n.TryStatement=function(e,t,r,s,n){this.type="TryStatement",this.block=r,this.handler=s,this.finalizer=n,this.start=e,this.end=t},n.ThrowStatement=function(e,t,r){this.type="ThrowStatement",this.argument=r,this.start=e,this.end=t},n.ReturnStatement=function(e,t,r){this.type="ReturnStatement",this.argument=r,this.start=e,this.end=t},n.BreakStatement=function(e,t,r){this.type="BreakStatement",this.label=r,this.start=e,this.end=t},n.ContinueStatement=function(e,t,r){this.type="ContinueStatement",this.label=r,this.start=e,this.end=t},n.ExpressionStatement=function(e,t,r){this.type="ExpressionStatement",this.expression=r,this.start=e,this.end=t},n.BlockStatement=function(e,t){this.type="BlockStatement",this.body=t,this.start=e.start,this.end=e.end},n.ProgramStatement=function(e,t,r){this.type="ProgramStatement",this.body=r,this.start=e,this.end=t},n.NumberLiteral=function(e){this.type="NumberLiteral",this.value=e.value,this.start=e.start,this.end=e.end},n.StringLiteral=function(e){this.type="StringLiteral",this.value=e.value,this.start=e.start,this.end=e.end},n.ArrayLiteral=function(e,t){this.type="ArrayLiteral",this.elements=t,this.start=e.start,this.end=e.end},n.RegExpLiteral=function(e,t,r,s){this.type="RegExpLiteral",this.regex={pattern:r,flags:s},this.start=e,this.end=t},n.ObjectLiteral=function(e,t){this.type="ObjectLiteral",this.properties=t,this.start=e.start,this.end=e.end},n.MemberExpression=function(e,t,r,s,n){this.type="MemberExpression",this.object=r,this.property=s,this.is_computed=!!n,this.start=e,this.end=t},n.CallExpression=function(e,t,r,s){this.type="CallExpression",this.callee=r,this.arguments=s,this.start=e,this.end=t},n.NewExpression=function(e,t,r,s){this.type="NewExpression",this.callee=r,this.arguments=s,this.start=e,this.end=t},n.UnaryExpression=function(e,t,r,s,n){this.type="UnaryExpression",this.operator=r,this.argument=s,this.is_prefix=!!n,this.start=e,this.end=t},n.LogicalExpression=function(e,t,r,s,n){this.type="LogicalExpression",this.operator=s,this.left=r,this.right=n,this.start=e,this.end=t},n.BinaryExpression=function(e,t,r,s,n){this.type="BinaryExpression",this.operator=s,this.left=r,this.right=n,this.start=e,this.end=t},n.AssignmentExpression=function(e,t,r,s,n){this.type="AssignmentExpression",this.operator=s,this.left=r,this.right=n,this.start=e,this.end=t},n.ConditionalExpression=function(e,t,r,s,n){this.type="ConditionalExpression",this.test=r,this.consequent=s,this.alternate=n,this.start=e,this.end=t},n.SequenceExpression=function(e){this.type="SequenceExpression",this.expressions=e,this.start=e[0].start,this.end=e[e.length-1].end},n.FunctionExpression=function(e,t,r,s,n){this.type="FunctionExpression",this.id=r,this.parameters=s,this.body=n,this.start=e,this.end=t},n.VariableDeclaration=function(e,t,r){this.type="VariableDeclaration",this.declarations=r,this.start=e,this.end=t},n.VariableDeclarator=function(e){this.type="VariableDeclarator",this.id=e,this.init=null,this.start=e.start,this.end=e.end},n.FunctionDeclaration=function(e,t,r,s,n){this.type="FunctionDeclaration",this.id=r,this.parameters=s,this.body=n,this.start=e,this.end=t},n.Comment=function(e){this.type="Comment",this.comment=e.value,this.start=e.start,this.end=e.end},n.Property=function(e,t){this.type="Property",this.key=e,this.value=null,this.is_computed=!!t,this.start=e.start},n.CatchClause=function(e,t,r,s){this.type="CatchClause",this.param=r,this.body=s,this.start=e,this.end=t},n.SwitchCase=function(e,t,r,s){this.type="SwitchCase",this.test=r,this.statements=s,this.start=e,this.end=t},n.DefaultCase=function(e,t,r){this.type="DefaultCase",this.statements=r,this.start=e,this.end=t},n.Identifier=function(e){this.type="Identifier",this.name=e.value,this.start=e.start},n.Operator=function(e){this.type="Operator",this.operator=e},n.Piece=function(e){this.start_token=e},n.Temp=function(){},n.File=function(e,t,r){this.type="File",this.name=e,this.code=t,this.program=r},n.Program=function(e){this.type="Program",this.body=e,this.start=e.length?e[0].start:{line:1,column:1,index:0},this.end=e.length?e[e.length-1].end:{line:1,column:1,index:0}},n.parse=function(t,r){this.raw_tokens=e(r);var s=this.parse_block_statement(this.raw_tokens);return new this.File(t,r,new this.Program(s))},n.parse_statement=function(e,t,r){for(var s,n=r;n<t.length;++n)switch(t[n].type){case"Identifier":if(n===r)switch(n=this.parse_identifier(e,t,n),e.identifier.name){case"function":return this.parse_function_declaration(e,t,r);case"var":return this.parse_variable_declaration(e,t,r,t.length);case"throw":return this.parse_statement_has_expression_argument(e,t,r,this.ThrowStatement);case"return":return this.parse_statement_has_expression_argument(e,t,r,this.ReturnStatement);case"if":return this.parse_if_statement(e,t,r);case"for":return this.parse_for_statement(e,t,r);case"while":return this.parse_while_statement(e,t,r);case"switch":return this.parse_switch_statement(e,t,r);case"try":return this.parse_try_statement(e,t,r);case"break":return this.parse_statement_has_label(e,t,r,this.BreakStatement);case"continue":return this.parse_statement_has_label(e,t,r,this.ContinueStatement)}break;case"Block":if(n===r)return e.statement=new this.BlockStatement(t[r],this.parse_block_statement(t[r].children)),n;break;case"Parenthesis":if(n===r)return this.parse_sequence_expression(e,t[n].children,0,t[n].children.length),e.statement=new this.ExpressionStatement(t[n].start,t[n+1].end,e.expression),n+1;break;case"SpecialCharacter":switch(t[n].value){case":":if(!s)return this.parse_labeled_statement(e,t,r);break;case";":return n===r?e.statement=new this.EmptyStatement(t[n]):this.parse_expression_statement(e,t,r,n),n;case"$":case"_":break;default:s=!0}break;case"Comment":return e.statement=new this.Comment(t[n]),n}if(n>r)return this.parse_expression_statement(e,t,r,n),n;throw Error("Executed unreachable code.")},n.parse_if_statement=function(e,t,r,s){var n,a,i,o=r+1;if(t[o]?"Parenthesis"===t[o].type?(n=this.parse_test(e,t[o].children),++o):t[o].error_unexpected_token():s.error_unexpected_token(),t[o]){if(o=this.parse_statement(e,t,o),!e.statement)throw Error("Fallback error");a=e.statement}else s.error_unexpected_token();if(t[o+1]&&"Identifier"===t[o+1].type&&"else"===t[o+1].value){if(!t[o+2])throw Error("Fallback error");o=this.parse_statement(e,t,o+2),i=e.statement}return e.statement=new this.IfStatement(t[r].start,t[o].end,n,a,i),o},n.parse_for_statement=function(e,t,r,s){var n,a,i,o,p,h,c=r+1;if(t[c])if("Parenthesis"===t[c].type){switch(this.parse_for_arguments(e,t[c].children),n=e.type){case"loop":a=e.init,i=e.test,o=e.update;break;case"in":p=e.left,h=e.right;break;default:throw Error("Fallback error")}++c}else t[c].error_unexpected_token();else s.error_unexpected_token();if(t[c]){if(c=this.parse_statement(e,t,c),!e.statement)throw Error("error");switch(n){case"loop":e.statement=new this.ForStatement(t[r].start,t[c].end,a,i,o,e.statement);break;case"in":e.statement=new this.ForInStatement(t[r].start,t[c].end,p,h,e.statement)}}else s.error_unexpected_token();return c},n.parse_while_statement=function(e,t,r,s){var n,a=r+1;if(t[a]?"Parenthesis"===t[a].type?(n=this.parse_test(e,t[a].children),a+=1):t[a].error_unexpected_token():s.error_unexpected_token(),t[a]){if(a=this.parse_statement(e,t,a),!e.statement)throw Error("Fallback error");e.statement=new this.WhileStatement(t[r].start,t[a].end,n,e.statement)}else s.error_unexpected_token();return a},n.parse_switch_statement=function(e,t,r,s){var n,a,i=r+1;if(t[i])if("Parenthesis"===t[i].type){if(this.parse_sequence_expression(e,t[i].children,0,t[i].children.length),!e.expression)throw Error("Fallback error");a=e.expression,i+=1}else t[i].error_unexpected_token();else s.error_unexpected_token();return t[i]?"Block"===t[i].type?n=this.parse_switch_cases(e,t[i].children):t[i].error_unexpected_token():s.error_unexpected_token(),e.statement=new this.SwitchStatement(t[r].start,t[i].end,a,n),i},n.parse_labeled_statement=function(e,t,r){var s,n;if(s=this.parse_identifier(e,t,r),n=e.identifier,!t[s+1])throw Error("Fallback error");return"SpecialCharacter"===t[s+1].type&&":"===t[s+1].value?(s=this.parse_statement(e,t,s+2,!0),e.statement=new this.LabeledStatement(t[r].start,e.statement.end,n,e.statement)):t[s+1].error_unexpected_token(),s},n.parse_try_statement=function(e,t,r,s){var n,a,i,o,p=r+1,h=null,c=null;if(t[p]?"Block"===t[p].type?(a=new this.BlockStatement(t[p],this.parse_block_statement(t[p].children)),++p):t[p].error_unexpected_token():s.error_unexpected_token(),t[p]&&"Identifier"===t[p].type&&"catch"===t[p].value){if(++p,t[p])if("Parenthesis"===t[p].type){if(n=this.parse_identifier(e,t[p].children,0),!e.identifier)throw Error("error");i=e.identifier,t[p].children.length>n+1&&t[p].children[n+1].error_unexpected_token(),p+=1}else t[p].error_unexpected_token();else s.error_unexpected_token();t[p]?"Block"===t[p].type?(o=new this.BlockStatement(t[p],this.parse_block_statement(t[p].children)),h=new this.CatchClause(t[p-2].start,t[p].end,i,o)):t[p].error_unexpected_token():s.error_unexpected_token()}if(t[p+1]&&"Identifier"===t[p+1].type&&"finally"===t[p+1].value)if(p+=2,t[p]){if("Block"!==t[p].type)throw Error("error");c=new this.BlockStatement(t[p],this.parse_block_statement(t[p].children))}else t[p].error_unexpected_token();if(!h&&!c)throw Error("Error");return e.statement=new this.TryStatement(t[r].start,t[p].end,a,h,c),p},n.parse_block_statement=function(e){var t=new this.Temp,r=0,s=[];if(this.statement_middlewares)return this.parse_block_statement_with_middlewares(t,e,s);for(;r<e.length;++r)r=this.parse_statement(t,e,r),s.push(t.statement);return s},n.parse_block_statement_with_middlewares=function(e,t,r){var s,n,a=0;e:for(;a<t.length;++a){for(s=0;s<this.statement_middlewares.length;++s)if((n=this.statement_middlewares[a](this,e,t,a))>a){a=n,r.push(e.statement);continue e}a=this.parse_statement(e,t,a),r.push(e.statement)}return r},n.parse_statement_has_expression_argument=function(e,t,r,s){var n=this.parse_sequence_expression(e,t,r+1,t.length);return e.statement=new s(t[r].start,t[n].end,e.expression),n},n.parse_statement_has_label=function(e,t,r,s){var n=r,a=null;return t[n+1]&&this.is_identifier(t[n+1])&&(n=this.parse_identifier(e,t,n+1),a=e.identifier),t[n+1]&&"SpecialCharacter"===t[n+1].type&&";"===t[n+1].value&&++n,e.statement=new s(t[r].start,t[n].end,a),n},n.parse_expression_statement=function(e,t,r,s){this.parse_sequence_expression(e,t,r,s),t[s]?e.statement=new this.ExpressionStatement(t[r].start,t[s].end,e.expression):e.statement=new this.ExpressionStatement(t[r].start,t[s-1].end,e.expression)},n.parse_number_literal=function(){},n.parse_variable_declaration=function(e,t,r,s){for(var n,a=r+1,i=[],o=!0;a<s;++a)switch(t[a].type){case"Number":t[a].error("Unexpected ILLEGAL token");break;case"Identifier":n&&t[a].error_unexpected_type(),a=this.parse_identifier(e,t,a),n=new this.VariableDeclarator(e.identifier),o=!1;break;case"SpecialCharacter":switch(t[a].value){case"=":if(n){if(!t[a+1])throw new Error("Fallback error");a=this.parse_expression(e,t,a+1,s),n.end=e.expression.end_token.end,n.init=e.expression.parsed_token,i.push(n),n=null}else t[a].error_unexpected_token();break;case"$":case"_":n&&t[a].error_unexpected_type(),a=this.parse_identifier(e,t,a),n=new this.VariableDeclarator(e.identifier),o=!1;break;case",":n?(i.push(n),n=null):o&&t[a].error_unexpected_token(),o=!0;break;case";":return o&&t[a].error_unexpected_token(),n&&i.push(n),e.statement=new this.VariableDeclaration(t[r].start,t[a].end,i),a;default:t[a].error_unexpected_token()}break;case"Comment":break;default:t[a].error_unexpected_token()}return i.push(n),e.statement=new this.VariableDeclaration(t[r].start,t[a-1].end,i),a-1},n.parse_function_declaration=function(e,t,r){var s,n,a,i=r+1;return t[i]&&(this.is_identifier(t[i])?(i=this.parse_identifier(e,t,i)+1,n=e.identifier):t[i].error_unexpected_token()),t[i]&&("Parenthesis"===t[i].type?(s=this.parse_parameters(e,t[i].children),++i):t[i].error_unexpected_token()),t[i]&&("Block"===t[i].type?a=new this.BlockStatement(t[i],this.parse_block_statement(t[i].children)):t[i].error_unexpected_token()),e.statement=new this.FunctionDeclaration(t[r].start,a.end,n,s,a),i},n.parse_expression=function(e,t,r,s,n){var a=0,i=[];e:for(;r<s;++r){if("SpecialCharacter"===t[r].type)switch(t[r].value){case",":case";":case n:if(0===i.length)return e.expression=null,r;break e}r=this.parse_expression_piece(e,t,r),e.piece.parsed_token&&i.push(e.piece)}for(this.assemble_pieces(i,0);a<i.length;++a)if(i[a]){e.expression=i[a];break}return r-1},n.parse_expression_piece=function(e,t,r){if(e.piece=new this.Piece(t[r]),this.expression_middlewares)for(var s=0;s<this.expression_middlewares.length;++s)if(r=this.expression_middlewares[s](this,e.piece,t,r),e.piece.parsed_token)return e.piece.end_token=t[r],r;switch(t[r].type){case"Number":e.piece.parsed_token=new this.NumberLiteral(t[r]);break;case"String":e.piece.parsed_token=new this.StringLiteral(t[r]);break;case"RegExp":r=this.parse_regex(e.piece,t,r);break;case"Identifier":switch(r=this.parse_identifier(e,t,r),e.identifier.name){case"in":case"void":case"delete":case"typeof":case"instanceof":e.piece.parsed_token=new this.Operator(e.identifier.name);break;default:e.piece.parsed_token=e.identifier}e.piece.start_token=e.piece.end_token=e.token;break;case"Array":case"Block":case"Parenthesis":e.piece.parsed_token={type:t[r].type};break;case"SpecialCharacter":switch(t[r].value){case"_":case"$":r=this.parse_identifier(e,t,r),e.piece.parsed_token=e.identifier,e.piece.start_token=e.piece.end_token=e.token;break;default:r=this.parse_operators(e.piece,t,r)}break;case"Comment":e.piece.parsed_token=null}return e.piece.end_token||(e.piece.end_token=t[r]),r},n.parse_new_expression=function(e,t,r){var s,n=t+1;for(this.assemble_pieces(e,n,r,"Parenthesis");n<e.length;++n)if(e[n]){s=e[n],e[n]=null;break}return"CallExpression"===s.parsed_token.type?e[t].parsed_token=new this.NewExpression(e[t].start_token.start,s.end_token.end,s.parsed_token.callee,s.parsed_token.arguments):e[t].parsed_token=new this.NewExpression(e[t].start_token.start,s.end_token.end,s.parsed_token,[]),e[t].end_token=s.end_token,n},n.parse_unary_expression=function(e,t,r){for(var s,n,a,i=0;i<t.length;++i)switch(n=t[i],e[n].parsed_token.operator){case"--":case"++":return e[n-1]&&e[n-1].parsed_token&&"Operator"!==e[n-1].parsed_token.type&&"NumberLiteral"!==e[n-1].parsed_token.type?(e[n-1].parsed_token=new this.UnaryExpression(e[n-1].start_token.start,e[n].end_token.end,e[n].parsed_token.operator,e[n-1].parsed_token),e[n-1].end_token=e[n].end_token):e[n+1]&&e[n+1].parsed_token&&"Operator"!==e[n+1].parsed_token.type&&"NumberLiteral"!==e[n+1].parsed_token.type&&(e[n+1].parsed_token=new this.UnaryExpression(e[n].start_token.start,e[n+1].end_token.end,e[n].parsed_token.operator,e[n+1].parsed_token,!0),e[n+1].start_token=e[n].start_token),void(e[n]=null);case"+":case"-":case"!":case"~":case"void":case"delete":case"typeof":for(s=n+1;s<e.length;++s)if(e[s]){a=e[s],e[s]=null;break}a||r.error_unexpected_token(),a.parsed_token&&"Operator"===a.parsed_token.type&&a.start_token.error_unexpected_token(),a&&(e[n].parsed_token=new this.UnaryExpression(e[n].start_token.start,a.end_token.end,e[n].parsed_token.operator,a.parsed_token,!0),e[n].end_token=a.end_token)}},n.parse_binary_expression=function(e,t,r){for(var s,n,a,i=0;i<t.length;++i){for(s=t[i]-1;s>=0;--s)if(e[s]){n=e[s],e[s]=null;break}for(s=t[i]+1;s<e.length;++s)if(e[s]){a=e[s],e[s]=null;break}e[t[i]].parsed_token=new r(n.start_token.start,a.end_token.end,n.parsed_token,e[t[i]].parsed_token.operator,a.parsed_token),e[t[i]].start_token=n.start_token,e[t[i]].end_token=a.end_token}},n.parse_member_expression=function(e,t){var r,s,n;switch(e[t].parsed_token.type){case"Operator":for(r=t-1;r>=0;--r)if(e[r]){if(s=e[r],"Parenthesis"===s.parsed_token.type)return!1;e[r]=null;break}for(r=t+1;r>=0;++r)if(e[r]){n=e[r],e[r]=null;break}e[t].parsed_token=new this.MemberExpression(s.start_token.start,n.end_token.end,s.parsed_token,n.parsed_token),e[t].start_token=s.start_token,e[t].end_token=n.end_token;break;case"Array":for(r=t-1;r>=0;--r)if(e[r]&&"Operator"!==e[r].parsed_token.type){if(s=e[r],"Parenthesis"===s.parsed_token.type)return!1;e[r]=null;break}if(n=e[t].parsed_token,this.parse_sequence_expression(n,e[t].start_token.children,0,e[t].start_token.children.length),!n.expression)throw Error("Fallback error");e[t].parsed_token=new this.MemberExpression(s.start_token.start,e[t].end_token.end,s.parsed_token,n.expression,!0),e[t].start_token=s.start_token}return!0},n.parse_function_expression=function(e,t,r){var s,n,a=null,i=t+1;return e[i]?"Identifier"===e[i].parsed_token.type?(a=e[i].parsed_token,e[i]=null,++i):"Parenthesis"!==e[i].parsed_token.type&&e[i].start_token.error_unexpected_token():r.error_unexpected_token(),e[i]?"Parenthesis"===e[i].parsed_token.type?(s=this.parse_parameters(e[i],e[i].start_token.children),e[i]=null,++i):e[i].start_token.error_unexpected_token():r.error_unexpected_token(),e[i]?"Block"===e[i].parsed_token.type?(n=new this.BlockStatement(e[i].start_token,this.parse_block_statement(e[i].start_token.children)),e[i]=null):e[i].start_token.error_unexpected_token():r.error_unexpected_token(),e[t].parsed_token=new this.FunctionExpression(e[t].start_token.start,n.end,a,s,n),i},n.parse_sequence_expression=function(e,t,r,s,n,a){var i=[];if(0===t.length||r>=t.length||"SpecialCharacter"===t[r].type&&";"===t[r].value)return n?e.expressions=i:e.expression=null,r;e:for(;r<s;++r)if(r=this.parse_expression(e,t,r,s,a),e.expression&&i.push(e.expression.parsed_token),t[r+1])if("SpecialCharacter"===t[r+1].type)switch(t[r+1].value){case";":case a:r+=2;break e;case",":++r;break;default:t[r+1].error_unexpected_token()}else t[r+1].error_unexpected_token();return n?e.expressions=i:i.length>1?e.expression=new this.SequenceExpression(i):1===i.length?e.expression=i[0]:e.expression=null,r-1},n.parse_assignment_expression=function(e,t){for(var r,s,n,a=0;a<t.length;++a){for(r=t[a]-1;r>=0;--r)if(e[r]){s=e[r],e[r]=null;break}switch(s.parsed_token.type){case"Identifier":case"MemberExpression":case"AssignmentExpression":break;default:s.start_token.error("Assigning to rvalue")}for(r=t[a]+1;r<e.length;++r)if(e[r]){n=e[r],e[r]=null;break}e[t[a]].parsed_token=new this.AssignmentExpression(s.start_token.start,n.end_token.end,s.parsed_token,e[t[a]].parsed_token.operator,n.parsed_token),e[t[a]].start_token=s.start_token,e[t[a]].end_token=n.end_token}},n.parse_conditional_expression=function(e,t){for(var r,s,n,a,i,o=0;o<t.length;++o,n=null){for(r=t[o]-1;r>=0;--r)if(e[r]){s=r,n=e[r];break}if(!n)throw Error("Fallback error");if("Operator"===n.parsed_token.type)throw Error("Fallback error");for(r=t[o]+1;r<e.length;++r)if(e[r]){a=e[r],e[r]=null;break}for(r=t[o]+1;r<e.length;++r)if(e[r]){"Operator"===e[r].parsed_token.type?e[r]=null:e[r].start_token.error_unexpected_token();break}for(r=t[o]+1;r<e.length;++r)if(e[r]){i=e[r],e[r]=null;break}e[t[o]]=null,e[s].parsed_token=new this.ConditionalExpression(n.start_token.start,i.end_token.end,n.parsed_token,a.parsed_token,i.parsed_token),e[s].start_token=n.start_token,e[s].end_token=i.end_token}},n.parse_array=function(e){for(var t=0,r=new this.Temp,s=[];t<e.length;++t)"SpecialCharacter"===e[t].type&&","===e[t].value?r.to_add?(s.push(r.expression.parsed_token),r.to_add=!1):s.push(null):(t=this.parse_expression(r,e,t,e.length),r.to_add=!0);return r.to_add&&s.push(r.expression.parsed_token),s},n.parse_switch_cases=function(e,t){var r,s,n,a,i=0,o=[];e:for(;i<t.length;++i){switch(t[i].type){case"Comment":o.push(new this.Comment(t[i]));continue e;case"Identifier":break;default:t[i].error_unexpected_token()}t:switch(t[i].value){case"case":if(r=i,!t[i+1])throw new Error("Fallback error");if("SpecialCharacter"===t[i+1].type&&":"===t[i+1].value?t[i+1].error_unexpected_token():i=this.parse_sequence_expression(e,t,i+1,t.length,!1,":"),!t[i])throw new Error("Fallback error");if("SpecialCharacter"===t[i].type&&":"===t[i].value){if(n=e.expression,a=[],i+1===t.length){o.push(new this.SwitchCase(t[r].start,t[i].end,n,a));break}r:for(s=i+1;s<t.length;++s)switch(t[s].type){case"Comment":break;case"Identifier":switch(t[s].value){case"case":case"default":o.push(new this.SwitchCase(t[r].start,t[i].end,n,a));break t}break r;default:break r}r:for(++i;i<t.length&&(i=this.parse_statement(e,t,i),a.push(e.statement),t[i+1]&&"Identifier"===t[i+1].type);++i)switch(t[i+1].value){case"case":case"default":break r}o.push(new this.SwitchCase(t[r].start,t[i].end,n,a))}else t[i].error_unexpected_token();break;case"default":if(r=i,!t[i+1])throw new Error("Fallback error");if("SpecialCharacter"===t[i+1].type&&":"===t[i+1].value){if(++i,a=[],i+1===t.length){o.push(new this.DefaultCase(t[r].start,t[i].end,a));break}r:for(s=i+1;s<t.length;++s)switch(t[s].type){case"Comment":break;case"Identifier":switch(t[s].value){case"case":case"default":o.push(new this.DefaultCase(t[r].start,t[i].end,a));break t}break r;default:break r}r:for(++i;i<t.length&&(i=this.parse_statement(e,t,i),a.push(e.statement),t[i+1]&&"Identifier"===t[i+1].type);++i)switch(t[i+1].value){case"case":case"default":break r}o.push(new this.DefaultCase(t[r].start,t[i].end,a))}else t[i].error_unexpected_token();break;default:t[i].error_unexpected_token()}}return o},n.parse_operators=function(e,t,r){switch(t[r].value){case".":return e.parsed_token=new this.Operator("."),r;case"-":return"-"===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("--"),r+1):"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("-="),r+1):(e.parsed_token=new this.Operator("-"),r);case"+":return"+"===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("++"),r+1):"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("+="),r+1):(e.parsed_token=new this.Operator("+"),r);case"/":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("/="),r+1):(e.parsed_token=new this.Operator("/"),r);case"*":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("*="),r+1):(e.parsed_token=new this.Operator("*"),r);case"%":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("%="),r+1):(e.parsed_token=new this.Operator("%"),r);case"=":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?"="===t[r+2].value&&t[r+2].start.index===t[r+1].end.index?(e.parsed_token=new this.Operator("==="),r+2):(e.parsed_token=new this.Operator("=="),r+1):(e.parsed_token=new this.Operator("="),r);case"&":return"&"===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("&&"),r+1):(e.parsed_token=new this.Operator("&"),r);case"|":return"|"===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("||"),r+1):(e.parsed_token=new this.Operator("|"),r);case">":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator(">="),r+1):(e.parsed_token=new this.Operator(">"),r);case"<":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?(e.parsed_token=new this.Operator("<="),r+1):(e.parsed_token=new this.Operator("<"),r);case"!":return"="===t[r+1].value&&t[r+1].start.index===t[r].end.index?"="===t[r+2].value&&t[r+2].start.index===t[r+1].end.index?(e.parsed_token=new this.Operator("!=="),r+2):(e.parsed_token=new this.Operator("!="),r+1):(e.parsed_token=new this.Operator("!"),r);case"?":case":":return e.parsed_token=new this.Operator(t[r].value),r;default:t[r].error_unexpected_token()}},n.parse_identifier=function(e,r,s){var n=s+1,a=e.token=new t,i=e.identifier=new this.Identifier(r[s]);e:for(;n<r.length;++n)switch(r[n].type){case"Number":case"Identifier":if(r[n-1].end.index!==r[n].start.index)break e;i.name=i.name+r[n].value;break;case"SpecialCharacter":switch(r[n].value){case"$":case"_":if(r[n-1].end.index!==r[n].start.index)break e;i.name=i.name+r[n].value;break;default:break e}break;default:break e}return i.end=r[n-1].end,a.type="Identifier",a.value=i.name,a.start=r[s].start,a.end=r[n-1].end,n-1},n.parse_parenthesis=function(e,t){var r,s,n=0,a=e[t[0]].parsed_token;e:for(;n<t.length;++n)for(r=t[n]-1;r>=0;--r)if(e[r]){"Operator"!==e[r].parsed_token.type?(s=this.parse_arguments(a,e[t[n]].start_token.children),e[t[n]].parsed_token=new this.CallExpression(e[r].start_token.start,e[t[n]].end_token.end,e[r].parsed_token,s),e[t[n]].start_token=e[r].start_token,e[r]=null):(this.parse_sequence_expression(a,e[t[n]].start_token.children,0,e[t[n]].start_token.children.length),e[t[n]].parsed_token=a.expression);continue e}},n.REGEX_FLAGS="gimuy",n.parse_regex=function(e,t,r){var s,n,a=r+1,i=0,o="";if(t[a]&&t[r].end.index===t[a].start.index&&"Identifier"===t[a].type)for(n=t[a].value,s=!0,i=n.length-1;i>=0;--i)-1!==this.REGEX_FLAGS.indexOf(n.charAt(i))&&-1===o.indexOf(n.charAt(i))?o+=n.charAt(i):t[a].error("Invalid regular expression flags");return s||(o="",a=r),e.parsed_token=new this.RegExpLiteral(t[r].start,t[a].end,t[r].value,o),a},n.parse_arguments=function(e,t){return this.parse_sequence_expression(e,t,0,t.length,!0),e.expressions},n.parse_for_arguments=function(e,t){var r=t[0]&&"Identifier"===t[0].type&&"var"===t[0].value,s=r?1:0;if(!t[s])throw Error("error");switch(e.identifier=null,this.is_identifier(t[s])?(s=this.parse_identifier(e,t,s),e.type=t[s+1]&&"in"===t[s+1].value?"in":"loop"):e.type="loop",e.type){case"in":if(e.left=r?new this.VariableDeclaration(t[0].start,e.identifier.end,[new this.VariableDeclarator(e.identifier)]):e.identifier,s=this.parse_sequence_expression(e,t,s+2,t.length),!e.expression)throw Error("error");e.right=e.expression;break;case"loop":if(r?(s=this.parse_variable_declaration(e,t,0,t.length),e.init=e.statement):(s=this.parse_sequence_expression(e,t,0,t.length),e.init=e.expression),"SpecialCharacter"!==t[s].type||";"!==t[s].value)throw Error("ERROR");if(s=this.parse_sequence_expression(e,t,s+1,t.length),e.test=e.expression,"SpecialCharacter"!==t[s].type||";"!==t[s].value)throw Error("ERROR");s=this.parse_sequence_expression(e,t,s+1,t.length),e.update=e.expression}},n.parse_parameters=function(e,t){for(var r=0,s=[];r<t.length;++r)this.is_identifier(t[r])?(r=this.parse_identifier(e,t,r),t[r+1]&&("SpecialCharacter"===t[r+1].type&&","===t[r+1].value?++r:t[r+1].error_unexpected_token()),s.push(e.identifier)):t[r].error_unexpected_token();return s},n.parse_test=function(e,t){if(this.parse_sequence_expression(e,t,0,t.length),e.expression)return e.expression;throw Error("Fallback error")},n.parse_object_literal=function(e){for(var t,r,s=0,n=[],a=new this.Temp,i=e.children;s<i.length;++s)if(t||!this.is_identifier(i[s]))switch(i[s].type){case"Number":t&&i[s].error_unexpected_type(),t=new this.Property(new this.NumberLiteral(i[s])),r=!0;break;case"String":t&&i[s].error_unexpected_type(),t=new this.Property(new this.StringLiteral(i[s])),r=!0;break;case"Array":break;case"SpecialCharacter":switch(i[s].value){case":":r?(s=this.parse_expression(a,i,s+1,i.length),r=!1,t.value=a.expression.parsed_token):t?(s=this.parse_expression(a,i,s+1,i.length),t.value=a.expression.parsed_token):i[s].error_unexpected_token(),n.push(t),t=null;break;case",":r?i[s].error_unexpected_token():t&&(t.value=t.key,t.end=t.value.end,n.push(t),t=null);break;default:i[s].error_unexpected_token()}break;case"Comment":n.push(new this.Comment(i[s]));break;default:i[s].error_unexpected_token()}else s=this.parse_identifier(a,i,s),t=new this.Property(a.identifier);if(t){if(r)throw Error("Fallback error");t.value=t.key,t.end=t.value.end,n.push(t)}return new this.ObjectLiteral(e,n)},n.parse_block=function(e,t){e[t].parsed_token=this.parse_object_literal(e[t].start_token)},n.assemble_pieces=function(e,t,r,s){for(var n=[],a=[],i=[],o=[],p=[],h=[],c=[],d=[],l=[],_=[];t<e.length;++t){switch(e[t].parsed_token.type){case"Identifier":switch(e[t].parsed_token.name){case"new":t=this.parse_new_expression(e,t);break;case"function":t=this.parse_function_expression(e,t)}break;case"Operator":switch(e[t].parsed_token.operator){case"?":l.unshift(t);break;case"&&":case"||":d.push(t);break;case".":n.push({index:t});break;case"!":case"~":case"++":case"--":case"void":case"delete":case"typeof":i.unshift(t);break;case"<":case">":case"<=":case">=":case"==":case"===":case"!=":case"!==":c.push(t);break;case"+":case"-":0===t||e[t-1]&&"Operator"===e[t-1].parsed_token.type?i.unshift(t):p.push(t)
;break;case"*":case"/":case"%":o.push(t);break;case"=":case"+=":case"-=":case"*=":case"/=":case"%=":case"&=":case"^=":case"|=":case"**=":case"<<=":case">>=":case">>>=":_.push(t)}break;case"Parenthesis":0===t?(this.parse_sequence_expression(e[0],e[0].start_token.children,0,e[0].start_token.children.length),e[0].parsed_token=e[0].expression):a.push(t);break;case"Array":e[t-1]&&"Operator"!==e[t-1].parsed_token.type?n.push({index:t}):e[t].parsed_token=new this.ArrayLiteral(e[t].start_token,this.parse_array(e[t].start_token.children));break;case"Block":this.parse_block(e,t)}if(s&&e[t].parsed_token.type===s)break}for(t=0;t<n.length;++t)n[t].is_parsed=this.parse_member_expression(e,n[t].index);for(a.length&&this.parse_parenthesis(e,a),t=0;t<n.length;++t)n[t].is_parsed||this.parse_member_expression(e,n[t].index);this.parse_unary_expression(e,i),this.parse_binary_expression(e,o,this.BinaryExpression),this.parse_binary_expression(e,p,this.BinaryExpression),this.parse_binary_expression(e,h,this.BinaryExpression),this.parse_binary_expression(e,c,this.BinaryExpression),this.parse_binary_expression(e,d,this.LogicalExpression),this.parse_conditional_expression(e,l),this.parse_assignment_expression(e,_)},n.is_identifier=function(e){return"Identifier"===e.type||"$"===e.value||"_"===e.value},n.error_end_of_file=function(){this.raw_tokens[this.raw_tokens.length-1].error("Unexpected end of file")};var a=function(){this.statement_middlewares=[],this.expression_middlewares=[]};return n=a.prototype,n.JavascriptParser=s,n.clone_middlewares=function(e){for(var t=0,r=new Array(e.length);t<r.length;++t)r[t]=e[t];return r},n.statement=function(e){this.statement_middlewares?this.statement_middlewares.push(e):this.statement_middlewares=[e]},n.expression=function(e){this.expression_middlewares?this.expression_middlewares.push(e):this.expression_middlewares=[e]},n.parse=function(e,t){return new this.JavascriptParser(this.statement_middlewares&&this.clone_middlewares(this.statement_middlewares),this.expression_middlewares&&this.clone_middlewares(this.expression_middlewares)).parse(e,t)},a}),t.namespace("javascript.ES5_parser",["javascript.tokenizer","javascript.Parser"],function(e,t){var r=new t,s=function(){},n=s.prototype;n.TemplateLiteral=function(e,t){this.type="TemplateLiteral",this.body=t,this.start=e.start,this.end=e.end},n.TemplateLiteralString=function(e){this.type="TemplateLiteralString",this.value=e.value,this.start=e.start,this.end=e.end},n.TemplateLiteralExpression=function(e,t){this.type="TemplateLiteralExpression",this.expression=t,this.start=e.start,this.end=e.end},n.parse=function(e,t,r,s){if("TemplateLiteral"===r[s].type){for(var n=[],a=0;a<r[s].children.length;++a)switch(r[s].children[a].type){case"TemplateLiteral quasi string":n.push(new this.TemplateLiteralString(r[s].children[a]));break;case"TemplateLiteral expression":e.parse_sequence_expression(t,r[s].children[a].children,0,r[s].children[a].children.length),n.push(new this.TemplateLiteralExpression(r[s].children[a],t.expression));break;default:r[s].error_unexpected_token()}t.parsed_token=new this.TemplateLiteral(r[s],n)}return s};var a=new s;return r.expression(function(e,t,r,s){return a.parse(e,t,r,s)}),function(e,t){try{return r.parse(e,t)}catch(t){throw t.fileName=e,t.$stack=t.stack,t}}})})}(window.jeefo,window,document);